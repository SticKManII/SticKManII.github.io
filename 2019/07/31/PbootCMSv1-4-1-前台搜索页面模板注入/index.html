<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-corner-indicator.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="Even-Want" type="application/atom+xml">






<meta name="description" content="Vulnerability Description  &amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;PbootCMS v1.4.1最新版在解析模板中的if语句时存在漏洞，导致攻击者能通过搜索页面污染URL的方式达到污染模板内容的目的，从而在程序使用eval语句解析模板时，触发漏洞。  Vulnerable Packages&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;漏洞影响PbootCMSv">
<meta property="og:type" content="article">
<meta property="og:title" content="PbootCMSv1.4.1 前台搜索页面模板注入">
<meta property="og:url" content="http://yoursite.com/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/index.html">
<meta property="og:site_name" content="Even-Want">
<meta property="og:description" content="Vulnerability Description  &amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;PbootCMS v1.4.1最新版在解析模板中的if语句时存在漏洞，导致攻击者能通过搜索页面污染URL的方式达到污染模板内容的目的，从而在程序使用eval语句解析模板时，触发漏洞。  Vulnerable Packages&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;漏洞影响PbootCMSv">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/6.png">
<meta property="og:image" content="http://yoursite.com/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/8.png">
<meta property="og:image" content="http://yoursite.com/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/1.png">
<meta property="og:updated_time" content="2019-07-31T02:41:14.930Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PbootCMSv1.4.1 前台搜索页面模板注入">
<meta name="twitter:description" content="Vulnerability Description  &amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;PbootCMS v1.4.1最新版在解析模板中的if语句时存在漏洞，导致攻击者能通过搜索页面污染URL的方式达到污染模板内容的目的，从而在程序使用eval语句解析模板时，触发漏洞。  Vulnerable Packages&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;漏洞影响PbootCMSv">
<meta name="twitter:image" content="http://yoursite.com/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/6.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/">





  <title>PbootCMSv1.4.1 前台搜索页面模板注入 | Even-Want</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
   
<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/SticKManII" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Even-Want</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Even-Want">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/image/lf.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Even-Want">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">PbootCMSv1.4.1 前台搜索页面模板注入</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-31T10:37:20+08:00">
                2019-07-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,633
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Vulnerability-Description"><a href="#Vulnerability-Description" class="headerlink" title="Vulnerability Description"></a><strong><a href>Vulnerability Description</a></strong></h1><p>  <strong>&ensp;&ensp;&ensp;&ensp;PbootCMS v1.4.1最新版在解析模板中的if语句时存在漏洞，导致攻击者能通过搜索页面污染URL的方式达到污染模板内容的目的，从而在程序使用eval语句解析模板时，触发漏洞。</strong></p>
<p><br><br></p>
<h1 id="Vulnerable-Packages"><a href="#Vulnerable-Packages" class="headerlink" title="Vulnerable Packages"></a><strong><a href>Vulnerable Packages</a></strong></h1><p><strong>&ensp;&ensp;&ensp;&ensp;漏洞影响PbootCMSv1.4.1及之前版本</strong></p>
<p><br><br></p>
<h1 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a><strong><a href>Credits</a></strong></h1><p><strong>&ensp;&ensp;&ensp;&ensp;These vulnerabilities were discovered and researched by stick.wang@ZionLab from DBAppSecurity.</strong></p>
<p><br><br></p>
<h1 id="Technical-Description-Proof-of-Concept-Code"><a href="#Technical-Description-Proof-of-Concept-Code" class="headerlink" title="Technical Description / Proof of Concept Code"></a><strong><a href>Technical Description / Proof of Concept Code</a></strong></h1><p>Vulnerable cgi:/apps/home/controller/ParserController.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">parserIfLabel</span><span class="params">($content)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $pattern = <span class="string">'/\&#123;pboot:if\(([^&#125;]+)\)\&#125;([\s\S]*?)\&#123;\/pboot:if\&#125;/'</span>;</span><br><span class="line">    $pattern2 = <span class="string">'/pboot:([0-9])+if/'</span>;</span><br><span class="line">    <span class="keyword">if</span> (preg_match_all($pattern, $content, $matches)) &#123;</span><br><span class="line">        $count = count($matches[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $count; $i ++) &#123;</span><br><span class="line">            $flag = <span class="string">''</span>;</span><br><span class="line">            $out_html = <span class="string">''</span>;</span><br><span class="line">            $danger = <span class="keyword">false</span>;</span><br><span class="line">            </span><br><span class="line">            $white_fun = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">'date'</span>,</span><br><span class="line">                <span class="string">'in_array'</span>,</span><br><span class="line">                <span class="string">'explode'</span>,</span><br><span class="line">                <span class="string">'implode'</span></span><br><span class="line">            );</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 还原可能包含的保留内容，避免判断失效</span></span><br><span class="line">            $matches[<span class="number">1</span>][$i] = <span class="keyword">$this</span>-&gt;restorePreLabel($matches[<span class="number">1</span>][$i]);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 解码条件字符串</span></span><br><span class="line">            $matches[<span class="number">1</span>][$i] = decode_string($matches[<span class="number">1</span>][$i]);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 带有函数的条件语句进行安全校验</span></span><br><span class="line">            <span class="keyword">if</span> (preg_match_all(<span class="string">'/([\w]+)([\\\s]+)?\(/i'</span>, $matches[<span class="number">1</span>][$i], $matches2)) &#123;</span><br><span class="line">                <span class="keyword">foreach</span> ($matches2[<span class="number">1</span>] <span class="keyword">as</span> $value) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((function_exists($value) || preg_match(<span class="string">'/^eval$/i'</span>, $value)) &amp;&amp; ! in_array($value, $white_fun)) &#123;</span><br><span class="line">                        $danger = <span class="keyword">true</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 不允许从外部获取数据</span></span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/(\$_GET\[)|(\$_POST\[)|(\$_REQUEST\[)|(\$_COOKIE\[)|(\$_SESSION\[)/i'</span>, $matches[<span class="number">1</span>][$i])) &#123;</span><br><span class="line">                $danger = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 如果有危险函数，则不解析该IF</span></span><br><span class="line">            <span class="keyword">if</span> ($danger) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">'if('</span> . $matches[<span class="number">1</span>][$i] . <span class="string">')&#123;$flag="if";&#125;else&#123;$flag="else";&#125;'</span>);</span><br></pre></td></tr></table></figure>
<p><br><br><strong>&ensp;&ensp;&ensp;&ensp;如果我们能控制$matches[1][$i]的值，就能控制eval函数，那么我们看看前面有哪些过滤。</strong><br><strong>&ensp;&ensp;&ensp;&ensp;程序在前面首先使用正则，匹配出$matches[1][$i]中的有关于函数的值，然后使用两个条件去判断这个函数是否危险，第一个条件就是不能是程序已经定义过的或者存在eval关键字的，第二个条件是函数值必须在$white_fun这个白名单之中的值，两个条件如果有一个违法，那么就会被认定为危险函数，就不会解析这个if条件。<br>在第二个条件中，白名单咱们肯定绕不过去，那么只能从第一个条件入手。<br>在第一个条件中，如果我们能使得匹配出来的值并不是函数名这种，那么我们就能简单绕过。从正则表达式来看，应该是匹配()之前的值，但是在php中是允许可变函数的，也就是说$a=”phpinfo”;$a();这样是可以执行的，并且使用正则表达式的话，只会匹配到a，这当然不会是一个已经定义过的函数，更不会存在eval关键字，完美绕过。</strong><br><strong>&ensp;&ensp;&ensp;&ensp;继续往上看时能发现$matches[1][$i]是$content正则匹配而来，而从$pattern来分析，我们只需要将payload改为{pboot:if}{/pboot:if}这种即可，之后的restorePreLabel方法和decode_string方法并不会影响具体的结果。</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解析全局后置公共标签</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">parserAfter</span><span class="params">($content)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserSingleLabel($content); <span class="comment">// 单标签解析</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserSiteLabel($content); <span class="comment">// 站点标签</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserCompanyLabel($content); <span class="comment">// 公司标签</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserUserLabel($content); <span class="comment">// 自定义标签</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserNavLabel($content); <span class="comment">// 分类列表</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserSelectAllLabel($content); <span class="comment">// CMS筛选全部标签解析</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserSelectLabel($content); <span class="comment">// CMS筛选标签解析</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserSpecifySortLabel($content); <span class="comment">// 指定分类</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserListLabel($content); <span class="comment">// 指定列表</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserSpecifyContentLabel($content); <span class="comment">// 指定内容</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserContentPicsLabel($content); <span class="comment">// 内容多图</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserContentCheckboxLabel($content); <span class="comment">// 内容多选调取</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserContentTagsLabel($content); <span class="comment">// 内容tags调取</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserSlideLabel($content); <span class="comment">// 幻灯片</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserLinkLabel($content); <span class="comment">// 友情链接</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserMessageLabel($content); <span class="comment">// 留言板parserQrcodeLabel</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserFormLabel($content); <span class="comment">// 自定义表单</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserSubmitFormLabel($content); <span class="comment">// 自定义表单提交</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserQrcodeLabel($content); <span class="comment">// 二维码生成</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserPageLabel($content); <span class="comment">// CMS分页标签解析(需置后)</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserLoopLabel($content); <span class="comment">// LOOP语句(需置后)</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;parserIfLabel($content); <span class="comment">// IF语句(需置最后)</span></span><br><span class="line">    $content = <span class="keyword">$this</span>-&gt;restorePreLabel($content); <span class="comment">// 还原不需要解析的内容</span></span><br><span class="line">    <span class="keyword">return</span> $content;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>&ensp;&ensp;&ensp;&ensp;我们发现，这实际上是一个解析模板文件的过程，那如果我们像触发eval函数，就必须控制模板文件的内容，那如果要前端触发，就必须要有前端交互的功能。实际上，在该cms中，前端只有搜索和留言板，我们能够输入对应数据，而在搜索的时候，我们能发现存在对变量的过滤，但是我们可以加上#，在它之后我们能够加上其他字符。这里存在一个非常关键的地方，那就是在页面生成二维码的时候，会有一个”扫一扫 手机访问”字段，里面存放的就是我们访问的地址。</strong><br><img src="/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/6.png" alt="1"><br><strong>&ensp;&ensp;&ensp;&ensp;因此我们能通过这个利用点，去在content中插入恶意代码。但是我们又发现，在生成二维码之后，这个地址内容被url编码，导致解析IF时，不能够被正则匹配到。</strong><br><strong>&ensp;&ensp;&ensp;&ensp;进入parserQrcodeLabel方法查看</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解析二维码生成标签</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">parserQrcodeLabel</span><span class="params">($content)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $pattern = <span class="string">'/\&#123;pboot:qrcode(\s+[^&#125;]+)?\&#125;/'</span>;</span><br><span class="line">    <span class="keyword">if</span> (preg_match_all($pattern, $content, $matches)) &#123;</span><br><span class="line">        $count = count($matches[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $count; $i ++) &#123;</span><br><span class="line">            $params = <span class="keyword">$this</span>-&gt;parserParam($matches[<span class="number">1</span>][$i]);</span><br><span class="line">            $string = <span class="string">''</span>;</span><br><span class="line">            <span class="keyword">foreach</span> ($params <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">                <span class="keyword">switch</span> ($key) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">'string'</span>:</span><br><span class="line">                        $string = $value;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (! $string) &#123; <span class="comment">// 无内容不解析</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            $content = str_replace($matches[<span class="number">0</span>][$i], <span class="string">'&lt;img src="'</span> . CORE_DIR . <span class="string">'/qrcode.php?string='</span> . urlencode($string) . <span class="string">'" class="qrcode" alt="二维码"&gt;'</span>, $content);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $content;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>&ensp;&ensp;&ensp;&ensp;能看到进入该方法之后，会对正则匹配到的值进行urlencode操作，那么我们是不是可以通过改变对应值，使得正则不匹配之后的关键部分，不就能让代码不被编码了吗?</strong><br><strong>&ensp;&ensp;&ensp;&ensp;从正则表达式来看，是匹配{pboot:qrcode}之中的值，而在调试过程中的content值如下</strong><br><img src="/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/8.png" alt="1"><br><strong>&ensp;&ensp;&ensp;&ensp;如果我们在aaaa#之后加上一个},那么正则就只会匹配到新增的}之前的内容，也就避免了我们的数据被编码。</strong><br><br><br><br></p>
<blockquote>
<p><strong>POC:</strong><br><br></p>
</blockquote>
<p><img src="/2019/07/31/PbootCMSv1-4-1-前台搜索页面模板注入/1.png" alt="1"></p>
<p><br></p>
<p><br></p>
<p><br></p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a><strong><a href>Summary</a></strong><br></h1><p><strong>&ensp;&ensp;&ensp;&ensp;其实从代码中能看到，官方已经对eval这已经是严防死打了，但是依旧存在过滤不严的问题，配合前台传入的恶意模板内容，导致了这次的漏洞。实际上，官方也可以试试使用白名单的方式对模板内容进行解析，这样应该更加安全。</strong></p>
<p><br></p>
<h1 id="Report-Timeline"><a href="#Report-Timeline" class="headerlink" title="Report Timeline"></a><strong><a href>Report Timeline</a></strong></h1><ul>
<li><strong>2019-7-20: Report vulnerability information to the PbootCMS</strong></li>
<li><strong>2019-7-21: Official release of PbootCMS new version v.4.2</strong></li>
</ul>
<p><br></p>
<h1 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a><strong><a href>Disclaimer</a></strong></h1><p><strong>The author is not responsible for any misuse of the information contained herein and accepts no responsibility for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information or exploits by the author or elsewhere.</strong></p>

      
    </div>
    
    
    

    
	
    <div>
  
    
<div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>

  
    </div>
	
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/28/CVE-2017-8917-Joomla3-7-0-Core-SQL注入漏洞分析/" rel="next" title="CVE-2017-8917_Joomla3.7.0_Core_SQL注入漏洞分析">
                <i class="fa fa-chevron-left"></i> CVE-2017-8917_Joomla3.7.0_Core_SQL注入漏洞分析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMzM3Mi85OTI4"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/image/lf.jpeg" alt="Even-Want">
            
              <p class="site-author-name" itemprop="name">Even-Want</p>
              <p class="site-description motion-element" itemprop="description">安全小白,目前web、系统双管齐下，喜欢代码审计、python、pwn、渗透</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=29816800&auto=1&height=66"></iframe>
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Vulnerability-Description"><span class="nav-number">1.</span> <span class="nav-text">Vulnerability Description</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Vulnerable-Packages"><span class="nav-number">2.</span> <span class="nav-text">Vulnerable Packages</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Credits"><span class="nav-number">3.</span> <span class="nav-text">Credits</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Technical-Description-Proof-of-Concept-Code"><span class="nav-number">4.</span> <span class="nav-text">Technical Description / Proof of Concept Code</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Summary"><span class="nav-number">5.</span> <span class="nav-text">Summary</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Report-Timeline"><span class="nav-number">6.</span> <span class="nav-text">Report Timeline</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Disclaimer"><span class="nav-number">7.</span> <span class="nav-text">Disclaimer</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Even-Want</span>

  
</div>


<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

  







  




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":"wanko","bottom":-30,"mobileShow":false,"tagMode":true,"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script>
</body>
</html>
<script type="text/javascript" src="/js/src/love.js"></script>